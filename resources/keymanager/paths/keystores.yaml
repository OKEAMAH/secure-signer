get:
  operationId: KEYMANAGER_LIST
  summary: List Keys.
  description: |
    Returns a list of hex-encoded BLS public keys for the private BLS keys that were imported to Secure-Signer.
  security:
    - bearerAuth: []
  tags:
    - Keymanager
  responses:
    "200":
      description: Success response
      content:
        application/json:
          schema:
            title: ListKeysResponse
            type: object
            required: [data]
            properties:
              data:
                type: array
                items:
                  type: object
                  required: [pubkey]
                  properties:
                    pubkey:
                      $ref: "../schemas.yaml#/components/schemas/Pubkey"
    "401":
      $ref: "../schemas.yaml#/components/responses/Unauthorized"
    "403":
      $ref: "../schemas.yaml#/components/responses/Forbidden"
    "500":
      $ref: "../schemas.yaml#/components/responses/InternalError"

post:
  operationId: KEYMANAGER_IMPORT
  summary: Import Keystores.
  description: |
    Import keystores generated by the Eth2.0 deposit CLI tooling. `passwords[i]` must unlock `keystores[i]`.
    Users SHOULD send slashing_protection data associated with the imported pubkeys. MUST follow the format defined in
    EIP-3076: Slashing Protection Interchange Format.
  security:
    - bearerAuth: []
  tags:
    - Keymanager
  requestBody:
    content:
      application/json:
        schema:
          type: object
          required: [keystores, passwords]
          properties:
            keystores:
              type: array
              description: JSON-encoded keystore files generated with the Launchpad.
              items:
                $ref: "../schemas.yaml#/components/schemas/Keystore"
            passwords:
              type: array
              description: Passwords to unlock imported keystore files. `passwords[i]` must unlock `keystores[i]`.
              items:
                type: string
                example: "ABCDEFGH01234567ABCDEFGH01234567"
            slashing_protection:
              $ref: "../schemas.yaml#/components/schemas/SlashingProtectionData"
  responses:
    "200":
      description: Success response
      content:
        application/json:
          schema:
            title: ImportKeystoresResponse
            type: object
            required: [data]
            properties:
              data:
                type: array
                description: Status result of each `request.keystores` with same length and order of `request.keystores`
                items:
                  type: object
                  required: [status]
                  properties:
                    status:
                      type: string
                      description: |
                        - imported: Keystore successfully decrypted and imported to keymanager permanent storage
                        - duplicate: Keystore's pubkey is already known to the keymanager
                        - error: Any other status different to the above: decrypting error, I/O errors, etc.
                      enum:
                        - imported
                        - duplicate
                        - error
                      example: imported
                    message:
                      type: string
                      description: error message if status == error
    "400":
      $ref: "../schemas.yaml#/components/responses/BadRequest"
    "401":
      $ref: "../schemas.yaml#/components/responses/Unauthorized"
    "403":
      $ref: "../schemas.yaml#/components/responses/Forbidden"
    "500":
      $ref: "../schemas.yaml#/components/responses/InternalError"